{
  "hash": "e17d00a0f070d5564de886ccadeddf6d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lecture 6 calculations\"\nsubtitle: Lecture 6\nformat:\n  revealjs:\n    theme: clean.scss\n    scrollable: true\n    footer: \"Lecture 6 - [Back to home](https://madfudolig.quarto.pub/introtobiostats/)\"\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n    slide-number: true\n    menu: true\n    code-annotations: hover\n    chalkboard: true\n    engine: knitr\n    echo: true\n    code-fold: false\n    \n  pdf: \n    number-sections: true\n    engine: knitr\nbibliography: references.bib\n---\n\n# Confidence Intervals\n\n## Confidence Interval Form\n\nThe confidence intervals in this chapter will follow the form:\n\n$$\nestimate \\pm reliability~coefficient*standard~error\n$$\n\n\n\n## Confidence Intervals for Population Means\n\nWe can estimate the population mean by using the mean of a representative sample from the population. \n\n::: callout-warning\nThe method differs for cases with known and unknown population variance. Some approximations can be done when there is a large sample size.\n:::\n\n## CI for Mean: Known Population Variance\n\nCases in which population variances are known are rare. The best example of measurements with known population variances are standardized scales. \n\n::: callout-note\nThe Wechsler Adult Intelligence Scale (WAIS) maintains a standard deviation of 15 points for its full scale IQ scores.\n:::\n\nFor a known population variance $\\sigma^2$, sample mean $\\bar{x}$, and sample size $n$, the 95% confidence limits for the $(1-\\alpha)%$ can be calculated using the following formula:\n\n$$\n\\bar{x} \\pm z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}\n$$\n\n## CI for Mean: Notes\n\nConfidence intervals are often written in parentheses notation as such:\n\n$$\n\\left(\\bar{x} - z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}, \\bar{x} + z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt{n}}\\right)\n$$\n\n$z_{1-\\alpha/2}$ is referred to as the reliability coefficient and defined as the following:\n\n$$\nP(Z \\leq z_{1-\\alpha/2}) = 1-\\alpha/2\n$$\n\n::: callout-tip\nRecall that $Z$ follows the standard normal distribution. $z_{1-\\alpha/2}$ can be calculated using  `qnorm(1-alpha/2,mean=0,sd=1).` For a 95% confidence interval, $\\alpha = 0.05$, then it follows that $1-\\alpha/2 = 1-0.05/2 = 0.975$. Therefore, the reliability coefficient for a 95% confidence interval can be calculated as:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalpha=0.05\nqnorm(1-alpha/2,mean=0,sd=1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.959964\n```\n\n\n:::\n:::\n\n:::\n\n## Example\n\nThe file `lec6example.csv` contains simulated values from a normal distribution with a variance of 4. \n\n::: panel-tabset\n\n### Question\n\nCreate a 95% confidence interval for the population mean. Is 1 a plausible value for the population mean?\n\n### Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# setwd(\"where your file is\")\nexample <- read.csv(\"datasets/lec6example.csv\")\nsdpop <- sqrt(4)\n```\n:::\n\nWe need to calculate the sample mean of the `Sims` column, the sample size, and the reliability coefficient.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxbar <- mean(example$Sims)\nsampsize <- nrow(example) # <1>\nalpha <- 1-0.95\nrelcoeff <- qnorm(1-alpha/2,mean = 0, sd=1) #<2>\n```\n:::\n\n1. `nrow()` calculates the number of rows of the data frame. If dealing with a singular vector, you can use `length()`. `nrow(example)` will yield the same answer as `length(example$Sims)`.\n\n\nWe can now calculate the 95% confidence interval limits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlower <- xbar - relcoeff*sdpop/sqrt(sampsize)\nupper <- xbar + relcoeff*sdpop/sqrt(sampsize)\nlower\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6637448\n```\n\n\n:::\n\n```{.r .cell-code}\nupper\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.303866\n```\n\n\n:::\n:::\n\nThe resulting 95% confidence interval is (0.66, 1.3). Since 1 is in the confidence interval, then we can claim that 1 is a plausible value for the population mean.\n\n:::\n\n## Exercise\n\nConsider the sleep health data uploaded on Canvas as `SleepHealthData.csv`. Suppose that in the population that this sample represents, the variance of the sleep duration is 0.5.\n\n::: panel-tabset\n### Question \n\nCalculate the 95% confidence interval for the average sleep duration (`sleep_duration`) in the population this sample represents. Is 7 hours a plausible value for the average sleep distribution of the population?\n\n### Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsleep <- read.csv(\"SleepHealthData.csv\")\nsdpop <- sqrt(0.5)\nxbar <- mean(sleep$sleep_duration)\nsampsize <- nrow(sleep)\nalpha <- 1-0.95\nrelcoeff <- qnorm(1-alpha/2) \n# not specifying the mean and sd in qnorm assumes standard normal\n\nlower <- xbar - relcoeff*sdpop/sqrt(sampsize)\nlower\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.060422\n```\n\n\n:::\n\n```{.r .cell-code}\nupper <- xbar + relcoeff*sdpop/sqrt(sampsize)\nupper\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.203749\n```\n\n\n:::\n:::\n\n\nThe 95% confidence interval is (7.06,7.2). 7 is not a plausible value for the average sleep distribution of the population.\n:::\n\n## Precision\n\nThe precision of an interval estimate is related to its width. \n\n::: callout-note\nThe precision, also known as the **margin of error**, can be expressed as the product of the reliability coefficient and the standard error.\n:::\n\nFor the case of the population mean with known population variance,\n\n$$\nprecision = z_{1-\\alpha/2}* \\frac{\\sigma}{\\sqrt{n}} = \\frac{upper-lower}{2}\n$$\n\n::: callout-note\nBecause of the symmetry of the confidence interval, the precision is half the width of the confidence interval.\n:::\n\n## CI for Mean: Unknown Population Variance\n\nIt is more common to not know the population variance when estimating the population mean. Because of this, we are inclined to use the next best thing: an estimate of the population variance from the collected sample. This estimate is the **sample variance**\n\n::: callout-warning\nUsing an approximate value for the population variance implies that our standardized statistic **might not** follow the standard normal distribution. We need a new distribution to calculate reliability coefficients for these confidence intervals.\n:::\n\n## The Student's t-distribution\n\nThe $t$ distribution is symmetric and bell-shaped like the normal distribution, but has heavier tails.\n\n::: callout-note\nHeavier tails mean that the distribution is more likely to produce values that fall farther from the mean compared to the normal distribution. The heavier tails account for the extra uncertainty introduced by using the sample variance to estimate the population variance.\n:::\n\n::: callout-important\nThe t-distribution is defined by the degrees of freedom denoted by $\\nu$ or `df`, and specific t-distributions can be written as $t_{\\nu}$.\n:::\n\n## The t distribution: `R`\n\nThe `R` syntax for the t-distribution with degrees of freedom `df` consists of the following functions:\n\n- PDF: `dt(x,df)`\n- CDF: `pt(x,df)`\n- Quantile: `qt(x,df)`\n- Generate/Simulate `n` t-distribution points: `rt(n,df)`\n\n## CI for Mean: Unknown Population Variance\n\nWhen the population variance is unknown OR the sample from a normally distributed population has a low sample size, the $(1-\\alpha)*100%$ confidence interval can be calculated using the following formula:\n\n$$\n\\bar{x} \\pm t_{\\nu,1-\\alpha/2} \\frac{s}{\\sqrt{n}}\n$$\n::: callout-important\n\n$s$ is the sample standard deviation $t_{\\nu,1-\\alpha/2}$ is defined as $P(t<t_{\\nu,1-\\alpha/2}) = 1-\\alpha/2$. The degrees of freedom $\\nu$ can be calculated as $\\nu=n-1$. \n\n:::\n\nThe 95% confidence interval can be written as:\n\n$$\n\\left(\\bar{x} - t_{\\nu,1-\\alpha/2} \\frac{s}{\\sqrt{n}}, \\bar{x} + t_{\\nu,1-\\alpha/2} \\frac{s}{\\sqrt{n}}\\right)\n$$\n## Precision\n\nThe precision of an interval estimate is related to its width. \n\n::: callout-note\nThe precision, also known as the **margin of error**, can be expressed as the product of the reliability coefficient and the standard error.\n:::\n\nFor the case of the population mean with unknown population variance,\n\n$$\nprecision = t_{\\nu,1-\\alpha/2} \\frac{s}{\\sqrt{n}}= \\frac{upper-lower}{2}\n$$\n\n::: callout-note\nBecause of the symmetry of the confidence interval, the precision is half the width of the confidence interval.\n:::\n\n\n\n## Example\n\nThe file `lec6example.csv` contains simulated values from a normal distribution. \n\n::: panel-tabset\n\n### Question\n\nSupposed the population variance is unknown. Create a 95% confidence interval for the population mean. Is 1 a plausible value for the population mean?\n\n### Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# setwd(\"where your file is\")\nexample <- read.csv(\"datasets/lec6example.csv\")\n```\n:::\n\nWe need to calculate the sample mean of the `Sims` column, the sample size, and the reliability coefficient.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxbar <- mean(example$Sims)\nsampsize <- nrow(example) # <1>\nstdev <- sd(example$Sims) # <2>\ndf <- sampsize-1 #<3>\nalpha <- 1-0.95\nrelcoeff <- qt(p=1-alpha/2,df=df) \n```\n:::\n\n1. `nrow()` calculates the number of rows of the data frame. If dealing with a singular vector, you can use `length()`. `nrow(example)` will yield the same answer as `length(example$Sims)`.\n2. We are calculating the sample variance using `sd()`.\n3. Degrees of freedom `df = n-1`.\n\n\nWe can now calculate the 95% confidence interval limits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlower <- xbar - relcoeff*stdev/sqrt(sampsize)\nupper <- xbar + relcoeff*stdev/sqrt(sampsize)\nlower\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6642442\n```\n\n\n:::\n\n```{.r .cell-code}\nupper\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.303367\n```\n\n\n:::\n:::\n\nThe resulting 95% confidence interval is (0.66, 1.3). Since 1 is in the confidence interval, then we can claim that 1 is a plausible value for the population mean.\n\n:::\n\n## Exercise\n\nConsider the sleep health data uploaded on Canvas as `SleepHealthData.csv`. \n\n::: panel-tabset\n### Question \n\nCalculate the **99%** confidence interval for the average heart rate (`heart_rate`) in bpm in the population this sample represents. Is 65 bpm a plausible value for the average sleep distribution of the population? Calculate the margin of error.\n\n### Answer\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsleep <- read.csv(\"SleepHealthData.csv\")\nsdpop <- sd(sleep$heart_rate)\nxbar <- mean(sleep$heart_rate)\nsampsize <- nrow(sleep)\nalpha <- 1-0.99\nrelcoeff <- qt(p=1-alpha/2,df=sampsize-1) \n# not specifying the mean and sd in qnorm assumes standard normal\n\nlower <- xbar - relcoeff*sdpop/sqrt(sampsize)\nlower\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 69.6121\n```\n\n\n:::\n\n```{.r .cell-code}\nupper <- xbar + relcoeff*sdpop/sqrt(sampsize)\nupper\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 70.71945\n```\n\n\n:::\n:::\n\n\nThe 95% confidence interval is (69.61,70.72). 65 is not a plausible value for the average heart rate of the population.\n\nThe margin of error can be calculated as:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrelcoeff*sdpop/sqrt(sampsize)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5536753\n```\n\n\n:::\n\n```{.r .cell-code}\n(upper-lower)/2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.5536753\n```\n\n\n:::\n:::\n\n\n:::\n\n",
    "supporting": [
      "lecture6-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}