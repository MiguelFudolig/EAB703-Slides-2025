---
title: "Sampling Distributions"
subtitle: Lecture 5
format:
  revealjs:
    theme: clean.scss
    scrollable: true
    footer: "Lecture 5 - [Back to home](https://madfudolig.quarto.pub/introtobiostats/)"
    code-block-bg: true
    code-block-border-left: "#31BAE9"
    slide-number: true
    menu: true
    code-annotations: hover
    chalkboard: true
    engine: knitr
    echo: true
    code-fold: false
    
  pdf: 
    number-sections: true
    engine: knitr
bibliography: references.bib
---

```{r setup}
#| echo: false

library(tidyverse)
```

# Outline 

- Importance of Sampling Distributions
- Distributions of the Sample Mean
- Distributions of the Difference Between Two Sample Means
- Distributions of the Sample Proportion
- Distributions of the Difference Between Two Proportions

# Importance of Sampling Distributions

## Activity

Let us use the "Sampling Words" applet through this [link](https://www.isi-stats.com/isi2nd/ISIapplets2021.html). Suppose we are interested in calculating the average word length of different samples of 10 words from Beyonce's Crazy in Love.

- Did we get the same average length for all samples?

## Sampling Distributions

Repeated samples will yield different values for the statistics. 

::: callout-note
We have to view statistics as the sample mean $\bar{x}$ and sample proportion $\hat{p}$ as random variables. The probability distribution of these statistics are called sampling distributions. These distributions enable us to:

- Answer probability questions about sample statistics
- Provide the necessary theory for some statistical inference tests.
:::

## Sampling Distributions

The sampling distribution of a statistic is the distribution of *all possible values* that can be assumed by some statistic computed from samples of the same size from the population.

::: callout-note
We are usually interested in knowing the functional form (refer to distributions discussed in Chapter 4), mean, and variance.
:::


# Distributions of the Sample Mean

## Sampling from Gaussian-distributed populations

For a sample with size $n$ that comes from a Gaussian-distributed population with mean $\mu$ and variance $\sigma^2$, i.e. the samples $X_1,X_2,...,X_n$ are all independent and identically distributed such that $X_i \sim N(\mu,\sigma^2)$, the sample mean can be defined as:

$$
\bar{X} = \frac{X_1 + X_2 + ... + X_n}{n}
$$

The probability distribution of the sample mean, also known as the sampling distribution of the sample mean can be expressed as:

$$
\bar{X} \sim N(\mu, \frac{\sigma^2}{n})
$$

## Implications

::: callout-important
The mean of the sampling distribution, $\mu_{\bar{X}}$ is equal to the population mean, while the variance, $\sigma^2_{\bar{X}}$ is reduced by a factor of the sample size $n$.

The standard deviation of the sampling distribution can be calculated by taking the square root of the variance of the distribution, $\sqrt{\frac{\sigma^2}{n}} = \frac{\sigma}{\sqrt{n}}$. This is referred to as the **standard error** of the sample mean.
:::

## Standardization

The sample mean can also be standardized based on the properties of the sampling distribution. The sample mean $\bar{X}$ can be transformed into a random variable $Z$ such that $Z \sim N(0,1)$.

$$
Z = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}}
$$
In addition,

$$
P(\bar{X} \leq \bar{x}) = P(Z \leq \frac{\bar{x} - \mu}{\sigma/\sqrt{n}}) = P(Z \leq z)
$$


## Sampling from Non-Gaussian Populations

The sampling distribution previously derived could also apply to samples from non-Gaussian populations under certain conditions. These conditions are provided by the **central limit theorem**.

::: {.callout-note title="Central Limit Theorem (CLT)"}
Given a population of any non-Gaussian functional form with a mean $\mu$ and finite variance $\sigma^2$, the sampling distribution of $\bar{x}$ computed from samples of size $n$ from this population, will have mean $\mu$ and variance $\sigma^2/n$ and will be approximately Gaussian distributed **when the sample size is large**.
:::

::: callout-tip
The rule of thumb for sample means is that a sample size of 30 is satisfactory for the central limit theorem, but this maybe too small for skewed distributions. The Gaussian approximation provided by the CLT becomes better as the sample size increases.
:::

## Example

Suppose it is known that in a certain large human population cranial length is approximately Gaussian distributed with a mean of 185.6 mm and a standard deviation of 12.7 mm. 

::: panel-tabset
### Question

What is the probability that a random sample of size 10 from this population will have a mean greater than 190?

### Answer
We can use the sampling distribution because we know the sample is from a Gaussian population. The mean of the sampling distribution, $\mu_\bar{X}$, should be equal to the population mean. Hence, $\mu_{\bar{X}} = 185.6$.

The standard error, $\sigma_{\bar{X}}$, can be calculated using the following formula: $\sigma_{\bar{X}} = \sigma/\sqrt{n} = 12.7/\sqrt{10} =$ `r round(12.7/sqrt(10),4)`

Using the knowledge that $\bar{X} \sim N(185.6, 12.7/\sqrt{10})$, we can use `pnorm` to calculate the probability that the sample mean is greater than 190.

```{r}
pnorm(190,mean=185.6,sd=12.7/sqrt(10),lower.tail=F)

z <- (190-185.6)/(12.7/sqrt(10))
pnorm(z,0,1,lower.tail=F)
```

:::

## Example 2

Suppose the hourly number of customer arrivals at a hospital ED has a Poisson distribution with rate parameter $\lambda=6$. Every hour for 48 hours, the number of customer arrivals is counted and recorded. 

::: panel-tabset
### Question

Use the CLT to approximate the probability that the average number of arrivals is between 5 and 8.

### Answer

The data is non-Gaussian, but we will assume that the CLT holds. Recall that for a Poisson distribution, the mean is equal to the variance. Specifically, $\mu=6$, $\sigma^2 = 6$, $n=48$. Hence, the mean and the standard error can be expressed as:

$$
\mu_{\bar{X}} = 6; \sigma_{\bar{X}} = \sqrt{6/48}
$$
The probability that the average number of arrivals in the 48-hour period is between 5 and 8 is:

```{r}
pnorm(8,6,sqrt(6/48)) - pnorm(5,6,sqrt(6/48))
```
:::

## Exercise

The daily average screen time of elementary school students is assumed to follow a non-Gaussian distribution with 2.6 hours with a standard deviation of 5.3. 

::: panel-tabset

### Question

Use the central limit theorem to calculate the probability that a sample of 250 elementary school students will yield an average screen time between 1.5 hours and 2 hours?  

### Answer

The mean of the sampling distribution is 2.6 hours and the standard error of the mean is $5.3/\sqrt{250} =$ `r 5.3/sqrt(250)`.

```{r}
pnorm(2,2.6,5.3/sqrt(250)) - pnorm(1.5,2.6,5.3/sqrt(250))
```

:::

# Distribution of the Difference Between Two Sample Means

## Sample Mean vs. Difference Between Two Sample Means

Consider Populations A and B with the following possible measurements: 

A: \{0,1,2\}; B:\{1,2,3\}. 

If we take a sample with size 2, we can have the following scenario: 

Sample A: \{0,2\}; Sample B: \{1,2\}

::: callout-warning
The sample mean of Sample A is 1, and the mean of Sample B is 1.5. However, the difference between the sample means is -0.5, which is not a possible value for the sample means of A and B.
:::


## Sampling from Gaussian-distributed populations

When sampling from two Gaussian-distributed populations $N(\mu_1,\sigma_1^2)$ and $N(\mu_2,\sigma_2^2)$, the distribution of the difference between sample means $\bar{X}_1 - \bar{X}_2$ is a Gaussian distribution with mean $\mu_1-\mu_2$ and variance $\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}$. Mathematically,

$$
\bar{X}_1 - \bar{X}_2 \sim N(\mu_1-\mu_2,\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2})
$$

## Standardization

Similar to the sample mean, the difference of the sample means can also be standardized.

$$
Z = \frac{(\bar{X}_1 - \bar{X}_2) - (\mu_1-\mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}
$$

In addition,

$$
P((\bar{X}_1 - \bar{X}_2) \leq (\bar{x}_1 - \bar{x}_2)) = P\left(Z \leq \frac{(\bar{x}_1 - \bar{x}_2) - (\mu_1-\mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}\right) 
$$

## Example

Suppose it has been established that for a certain type of client the average length of a home visit by a public health nurse is 45 minutes with a standard deviation of 15 minutes, and that for a second type of client the average home visit is 30 minutes long with a standard deviation of 20 minutes.

::: panel-tabset
### Question

If a nurse randomly visits 35 clients from the first and 40 from the second population, what is the probability that the average length of home visit will differ between client type one and client type two by 20 or more minutes?

### Answer

```{r}
# Calculate the mean and variance of the sampling distribution first.
diff_means <- 45-30 # <1> 
diff_var <- 15^2/35 + 20^2/40 # <2>

pnorm(20,diff_means,sqrt(diff_var),lower.tail=F)

# OR An alternative solution

z <- (20 - diff_means)/sqrt(diff_var) # <3>

pnorm(z,0,1,lower.tail=F)


```
1. mu_1-mu_2
2. sigma_1^2/n1 + sigma_2^2/n2
3. Standardization method

:::

## Exercise

Suppose the age of two student organizations were normally distributed. Organization A has an average age of 20.5 and a standard deviation of 3.7, while Organization B has an average of 19.7 and a standard deviation of 4.5. 

::: panel-tabset

### Question

If 50 students were sampled from each organization, what is the probability that the sample from Organization A is older than Organization B by a value between one and two years?

### Answer

```{r}
diff_means <- 20.5-19.7
diff_var <- 4.5^2/50 + 3.7^2/50

pnorm(2,diff_means,sqrt(diff_var))-pnorm(1,diff_means,sqrt(diff_var))

# OR An alternative solution

z1 <- (2 - diff_means)/sqrt(diff_var) 
z2 <- (1 - diff_means)/sqrt(diff_var) 

pnorm(z1,0,1) - pnorm(z2,0,1)
```


:::